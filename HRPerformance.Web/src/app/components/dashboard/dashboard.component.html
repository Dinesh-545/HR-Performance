<div class="dashboard-container">
  <div class="dashboard-header">
    <h1>HR Performance Management Dashboard</h1>
    <p>Welcome to your performance management overview</p>
  </div>

  <div class="dashboard-grid" *ngIf="!loading; else loadingTemplate">
    <!-- Key Metrics Cards -->
    <div class="metrics-section">
      <mat-card class="metric-card">
        <mat-card-content>
          <div class="metric-icon">
            <mat-icon>people</mat-icon>
          </div>
          <div class="metric-content">
            <h3>{{ totalEmployees }}</h3>
            <p>Total Employees</p>
          </div>
        </mat-card-content>
      </mat-card>

      <mat-card class="metric-card">
        <mat-card-content>
          <div class="metric-icon">
            <mat-icon>target</mat-icon>
          </div>
          <div class="metric-content">
            <h3>{{ activeGoals }}</h3>
            <p>Active Goals</p>
          </div>
        </mat-card-content>
      </mat-card>

      <mat-card class="metric-card">
        <mat-card-content>
          <div class="metric-icon">
            <mat-icon>check_circle</mat-icon>
          </div>
          <div class="metric-content">
            <h3>{{ completedGoals }}</h3>
            <p>Completed Goals</p>
          </div>
        </mat-card-content>
      </mat-card>

      <mat-card class="metric-card">
        <mat-card-content>
          <div class="metric-icon">
            <mat-icon>assessment</mat-icon>
          </div>
          <div class="metric-content">
            <h3>{{ pendingReviews }}</h3>
            <p>Pending Reviews</p>
          </div>
        </mat-card-content>
      </mat-card>
    </div>

    <!-- Goal Progress -->
    <mat-card class="progress-card">
      <mat-card-header>
        <mat-card-title>
          <mat-icon>trending_up</mat-icon>
          Goal Progress
        </mat-card-title>
      </mat-card-header>
      <mat-card-content>
        <div class="progress-info">
          <span>{{ completedGoals }} of {{ goals.length }} goals completed</span>
          <span class="progress-percentage">{{ getGoalProgress() | number:'1.0-0' }}%</span>
        </div>
        <mat-progress-bar 
          mode="determinate" 
          [value]="getGoalProgress()"
          color="primary">
        </mat-progress-bar>
      </mat-card-content>
    </mat-card>

    <!-- Recent Employees -->
    <mat-card class="recent-card">
      <mat-card-header>
        <mat-card-title>
          <mat-icon>people</mat-icon>
          Recent Employees
        </mat-card-title>
      </mat-card-header>
      <mat-card-content>
        <div class="employee-list" *ngIf="getRecentEmployees().length > 0; else noEmployees">
          <div class="recent-employee" *ngFor="let employee of employees.slice(0, 3)">
            <div class="employee-info">
              <h4>{{ getEmployeeName(employee) }}</h4>
              <p>{{ getEmployeeRole(employee) }}</p>
              <p class="email">{{ getEmployeeEmail(employee) }}</p>
            </div>
          </div>
        </div>
        <ng-template #noEmployees>
          <p>No employees found</p>
        </ng-template>
      </mat-card-content>
    </mat-card>

    <!-- Recent Goals -->
    <mat-card class="recent-card">
      <mat-card-header>
        <mat-card-title>
          <mat-icon>target</mat-icon>
          Recent Goals
        </mat-card-title>
      </mat-card-header>
      <mat-card-content>
        <div class="goal-list" *ngIf="getRecentGoals().length > 0; else noGoals">
          <div class="goal-item" *ngFor="let goal of getRecentGoals()">
            <div class="goal-header">
              <h4>{{ goal.Title || goal.title }}</h4>
              <mat-chip [color]="(goal.Status || goal.status) === 'Completed' ? 'accent' : 'primary'" selected>
                {{ goal.Status || goal.status }}
              </mat-chip>
            </div>
            <p>{{ goal.Description || goal.description }}</p>
            <div class="goal-dates">
              <small>Start: {{ (goal.StartDate || goal.startDate) | date:'shortDate' }}</small>
              <small>End: {{ (goal.EndDate || goal.endDate) | date:'shortDate' }}</small>
            </div>
          </div>
        </div>
        <ng-template #noGoals>
          <p>No goals found</p>
        </ng-template>
      </mat-card-content>
    </mat-card>

    <!-- Goal Status Chart -->
    <mat-card class="chart-card">
      <mat-card-header>
        <mat-card-title>
          <mat-icon>pie_chart</mat-icon>
          Goal Status Distribution
        </mat-card-title>
      </mat-card-header>
      <mat-card-content>
        <div class="chart-container">
          <canvas #goalChartCanvas></canvas>
        </div>
      </mat-card-content>
    </mat-card>

    <!-- Employee Distribution Chart -->
    <mat-card class="chart-card">
      <mat-card-header>
        <mat-card-title>
          <mat-icon>bar_chart</mat-icon>
          Employees by Department
        </mat-card-title>
      </mat-card-header>
      <mat-card-content>
        <div class="chart-container">
          <canvas #employeeChartCanvas></canvas>
        </div>
      </mat-card-content>
    </mat-card>

    <!-- Skills Distribution Chart -->
    <mat-card class="chart-card">
      <mat-card-header>
        <mat-card-title>
          <mat-icon>donut_large</mat-icon>
          Skills Distribution
        </mat-card-title>
      </mat-card-header>
      <mat-card-content>
        <div class="chart-container">
          <canvas #skillChartCanvas></canvas>
        </div>
      </mat-card-content>
    </mat-card>

    <!-- Skills Overview -->
    <mat-card class="skills-card">
      <mat-card-header>
        <mat-card-title>
          <mat-icon>psychology</mat-icon>
          Skills Overview
        </mat-card-title>
      </mat-card-header>
      <mat-card-content>
        <div class="skills-grid" *ngIf="skills.length > 0; else noSkills">
          <mat-chip *ngFor="let skill of skills" color="primary" selected>
            {{ skill.Name || skill.name }}
          </mat-chip>
        </div>
        <ng-template #noSkills>
          <p>No skills found</p>
        </ng-template>
      </mat-card-content>
    </mat-card>
  </div>

  <ng-template #loadingTemplate>
    <div class="loading-container">
      <mat-spinner></mat-spinner>
      <p>Loading dashboard data...</p>
    </div>
  </ng-template>
</div>
